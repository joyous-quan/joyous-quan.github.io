<!DOCTYPE html>
<html lang="zh-CN">
<head>
	<meta charset="UTF-8">
	<title>购物车</title>
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="renderer" content="webkit">
	<meta name="force-rendering" content="webkit">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<meta name="robots" content="index,follow">
	<meta content="telephone=no,email=no" name="format-detection">
	<link rel="shortcut icon" href="/static/img/favicon.ico" type="image/x-icon"/>
	<link rel="stylesheet" type="text/css" href="/static/iconfont/iconfont.css">
	<link rel="stylesheet" href="/static/css/common.css?t=202006110001" media="all">
	<link rel="stylesheet" href="/static/css/pay.css?t=202006110001" media="all">
	<script src="/static/js/jquery.min.js?t=202006110001"></script>
	<script src="/static/js/common.js?t=202006110001"></script>
</head>
<body>

<div id="header"></div>

<div class="layout">
	<div class="breadcrumb">
		<a href="/index.html">首页</a><i class="iconfont icon-gengduo"></i><a class="current">购物车</a>
	</div>
	<h3 class="common-title cart-title">购物车
		<label class="example">
			<a href="/static/upload/batchaddcart/productcart.xlsx" download="">[下载批量下单模板]</a>
			Excel上传批量加入购物车：<input type="file" id="upload">
		</label>
	</h3>

<div class="cart-con">
	<table class="tab_mycart tab_product">
		<thead>
			<tr>
				<td colspan="2"><label><input class="input_check" type="checkbox" checked="" id="cart_totle"> 全选</label></td>
				<td>商品信息</td>
				<td><span class="sp_phone_none">规格</span></td>
				<td class="td_phone_none">单价</td>
				<td class="td_phone_none">促销价</td>
				<td class="td_phone_none">VIP价</td>
				<td><span class="sp_phone_none paddingL20">数量</span></td>
				<td><span class="sp_phone_none">总价</span></td>
			</tr>
		</thead>
		<tbody>
			<tr>
			<td class="width30">
			<input class="input_check" type="checkbox" id="cart_0" checked="" onclick="_uptCartIsChecked(this)" cartid="25361">
			</td>
			<td class="width110">
			<a class="img-box" href="/products/14323-06-9.html" target="_blank"><img src="https://file.bidepharm.com/static/upload/proimg/121/14323-06-9.png"></a>
			</td>
			<td class="td_hover">
			<a class="a_name" href="/products/14323-06-9.html" target="_blank">三(2,2'-联吡啶)二氯化钌</a>
			<p><span>14323-06-9</span><span>BD18330</span>98%</p>
			<p class="fav_del"><a class="a_fav" onclick="_addFavorint('P000120593')">移入收藏夹</a><a class="a_del" cartid="25361">删除</a></p>
			</td>
			<td><span class="sp_size">5g</span></td>
			<td class="td_phone_none unit-price">￥1168.0</td>
			<td class="td_phone_none sales-price">￥1168.0</td>
			<td class="td_phone_none vip-price ">￥1051.2<input type="hidden" value="1051.2" class="unitprice"></td>
			<td class="td-mum">
			<a class="sp_ipt_number" cartid="25361">
			<span class="minus">-</span>
			<input type="text" onpropertychange="_upt_quantity_post(this)" onkeyup="_upt_quantity_post(this)" value="1">
			<span class="add">+</span>
			</a>
			</td>
			<td><span class="td-totle-price">￥<span class="sp_price">1051.2</span></span></td>
			</tr>

			<tr>
			<td class="width30">
			<input class="input_check" type="checkbox" id="cart_1" checked="" onclick="_uptCartIsChecked(this)" cartid="25360">
			</td>
			<td class="width110">
			<a class="img-box" href="/products/864163-80-4.html" target="_blank"><img src="https://file.bidepharm.com/static/upload/proimg/787/864163-80-4.png"></a>
			</td>
			<td class="td_hover">
			<a class="a_name" href="/products/864163-80-4.html" target="_blank">(2,2'-联吡啶)双[2-(2,4-二氟苯基)吡啶]铱(III) 六氟磷酸盐</a>
			<p><span>864163-80-4</span><span>BD00779408</span>80%</p>
			<p class="fav_del"><a class="a_fav" onclick="_addFavorint('P000120593')">移入收藏夹</a><a class="a_del" cartid="25361">删除</a></p>
			</td>
			<td><span class="sp_size">50mg</span></td>
			<td class="td_phone_none unit-price">￥288.0</td>
			<td class="td_phone_none sales-price">￥288.0</td>
			<td class="td_phone_none vip-price">￥259.2<input type="hidden" value="259.2" class="unitprice"></td>
			<td class="td-mum">
			<a class="sp_ipt_number" cartid="25360">
			<span class="minus">-</span>
			<input type="text" onpropertychange="_upt_quantity_post(this)" onkeyup="_upt_quantity_post(this)" value="1">
			<span class="add">+</span>
			</a>
			</td>
			<td><span class="td-totle-price">￥<span class="sp_price">259.2</span></span></td>
			</tr>
			<tr>
			<td class="width30">
			<input class="input_check" type="checkbox" id="cart_2" checked="" onclick="_uptCartIsChecked(this)" cartid="25359">
			</td><td class="width110">
			<a class="img-box" href="/products/94928-86-6.html" target="_blank"><img src="https://file.bidepharm.com/static/upload/proimg/61/94928-86-6.png"></a>
			</td>
			<td class="td_hover">
			<a class="a_name" href="/products/94928-86-6.html" target="_blank">fac-三(2-苯基吡啶)合铱</a>
			<p><span>94928-86-6</span><span>BD155809</span>98%</p>
			<p class="fav_del"><a class="a_fav" onclick="_addFavorint('P000060122')">移入收藏夹</a><a class="a_del" cartid="25359">删除</a></p>
			</td>
			<td><span class="sp_size">100mg</span></td>
			<td class="td_phone_none unit-price">￥517.0</td>
			<td class="td_phone_none sales-price">￥517.0</td>
			<td class="td_phone_none vip-price">￥465.3<input type="hidden" value="465.3" class="unitprice"></td>

			<td class="td-mum">
			<a class="sp_ipt_number" cartid="">
			<span class="minus">-</span>
			<input type="text" onpropertychange="_upt_quantity_post(this)" onkeyup="_upt_quantity_post(this)" value="2">
			<span class="add">+</span>
			</a>
			</td>
			<td><span class="td-totle-price">￥<span class="sp_price">930.6</span></span></td>
			</tr>
			<tr>
			<td class="width30">
			<input class="input_check" type="checkbox" id="cart_3" checked="" onclick="_uptCartIsChecked(this)" cartid="25358">
			</td><td class="width110">
			<a class="img-box" href="/products/14323-06-9.html" target="_blank"><img src="https://file.bidepharm.com/static/upload/proimg/121/14323-06-9.png"></a>
			</td>
			<td class="td_hover">
			<a class="a_name" href="/products/14323-06-9.html" target="_blank">三(2,2'-联吡啶)二氯化钌</a>
			<p><span>14323-06-9</span><span>BD18330</span>98%</p>
			<p class="fav_del"><a class="a_fav" onclick="_addFavorint('P000120593')">移入收藏夹</a><a class="a_del" cartid="25358">删除</a></p>
			</td>
			<td><span class="sp_size">1g</span></td>
			<td class="td_phone_none unit-price">￥293.0</td>
			<td class="td_phone_none sales-price">￥293.0</td>
			<td class="td_phone_none vip-price">￥263.7<input type="hidden" value="263.7" class="unitprice"></td>
			<td class="td-mum">
			<a class="sp_ipt_number" cartid="25358">
			<span class="minus">-</span>
			<input type="text" onpropertychange="_upt_quantity_post(this)" onkeyup="_upt_quantity_post(this)" value="1">
			<span class="add">+</span>
			</a>
			</td>
			<td><span class="td-totle-price">￥<span class="sp_price">263.7</span></span></td>
			</tr>
			<tr>
			<td class="width30">
			<input class="input_check" type="checkbox" id="cart_4" checked="" onclick="_uptCartIsChecked(this)" cartid="25357">
			</td>
			<td class="width110">
			<a class="img-box" href="/products/5336-90-3.html" target="_blank"><img src="https://file.bidepharm.com/static/upload/proimg/94/5336-90-3.png"></a>
			</td>
			<td class="td_hover">
			<a class="a_name" href="/products/5336-90-3.html" target="_blank">9-吖啶羧酸</a>
			<p><span>5336-90-3</span><span>BD15745</span>97%</p>
			<p class="fav_del"><a class="a_fav" onclick="_addFavorint('P000093666')">移入收藏夹</a><a class="a_del" cartid="25357">删除</a></p>
			</td>
			<td><span class="sp_size">1g</td>
			<td class="td_phone_none unit-price">￥187.0</td>
			<td class="td_phone_none sales-price">￥187.0</td>
			<td class="td_phone_none vip-price">￥168.3<input type="hidden" value="168.3" class="unitprice"></td>
			<td class="td-mum">
			<a class="sp_ipt_number" cartid="25357">
			<span class="minus">-</span>
			<input type="text" onpropertychange="_upt_quantity_post(this)" onkeyup="_upt_quantity_post(this)" value="3">
			<span class="add">+</span>
			</a>
			</td>
			<td><span class="td-totle-price">￥<span class="sp_price">504.90</span></span></td>
			</tr>
		</tbody>
	</table>
	<ul class="cart-payment">
		<li class="float-L">已选产品 <b class="sp_ltems">5</b>件</li>
		<li class="float-R">合计（不含运费）：<b class="cart-totle" id="lab_proallcoin">3009.60</b><a class="btn btn-yellow" id="checkout" onclick="_toPayMent()">结算</a>
		</li>
	</ul>
</div>
</div>


<div id="footer"></div>

<script>
$(function(){
if($(".sp_ipt_number").length>0){
$("#cart_totle").click(function(){
var tschk=$(this).is(":checked")?true:false;
$(".tab_mycart .input_check").prop("checked",tschk);
setTimeout(function(){_sumCoinUpt();_uptCartIsCheckedAll();},200);
});
$(".input_check").click(function(){
setTimeout(function(){_sumCoinUpt()},200);
});
$(".sp_ipt_number .minus").click(function(){
var id=$(this).parent().attr('cartid');
var ipt=$(this).parent().find('input');
var val=ipt.val();
var price=$(this).parent().parent().parent().find('.sp_price');
val=Number(val)-1;
if(val>0){
ipt.val(val>0?val:1);
_sumCoinUpt();
price.html(parseFloat(val*parseFloat($(this).parent().parent().parent().find('.unitprice').val())).toFixed(2));
var cartparams={"quantity":val};
/*_DoAjaxAsyncTrue("PUT",cartparams,'/webapi/v1/user/cart/'+id,function(){
_uptCartInfo();//更新购物车信息
});*/
}
});
$(".sp_ipt_number .add").click(function(){
var id=$(this).parent().attr('cartid');
var ipt=$(this).parent().find('input');
var val=Number(ipt.val())+1;
ipt.val(val);
_sumCoinUpt();
var price=$(this).parent().parent().parent().find('.sp_price');
price.html(parseFloat(val*parseFloat($(this).parent().parent().parent().find('.unitprice').val())).toFixed(2));
var cartparams={"quantity":val};
/*_DoAjaxAsyncTrue("PUT",cartparams,'/webapi/v1/user/cart/'+id,function(){
_uptCartInfo();//更新购物车信息
});*/
});
$(".tab_mycart .a_del").click(function(){
var thisobj=$(this);
var id=thisobj.attr('cartid');
/*_DoAjaxAsyncTrue("DELETE",{},'/webapi/v1/user/cart/'+id,function(){
_uptCartInfo();//更新购物车信息
bide._warn('删除成功!');
setTimeout(function(){layer.closeAll();},1500);
thisobj.parent().parent().remove();
_sumCoinUpt();
});*/
});
//_sumCoinUpt();
}
$("#upload").change(function() {_uploadFie('upload')});
})
//更新总价
function _sumCoinUpt(){
var itemLen=$(".tab_mycart tbody tr .input_check:checked").length;
$(".sp_ltems").html(itemLen);
var sumcoin=0;
$.each($(".tab_mycart tbody tr").has(":checked").find(".sp_ipt_number input"), function(idx, item) {
var rowprice=parseFloat($(item).parent().parent().parent().find('.unitprice').val()).toFixed(2);
sumcoin+=Number($(item).val())*rowprice;
});
$("#lab_proallcoin").html(sumcoin.toFixed(2));
}
//更新产品数量
function _upt_quantity_post(obj){
var ipt=$(obj);
var val=Number(ipt.val());
if(val>0){
var id=$(obj).parent().attr('cartId');
var price=$(obj).parent().parent().parent().find('.sp_price');
price.html(parseFloat(val*parseFloat($(obj).parent().parent().parent().find('.unitprice').val())).toFixed(2));
var cartparams={"quantity":val};
/*_DoAjaxAsyncTrue("PUT",cartparams,'/webapi/v1/user/cart/'+id);*/
_uptCartInfo();//更新购物车信息
_sumCoinUpt();
}else{
ipt.val(1);
}
}
//添加收藏
/*function _addFavorint(proid){
if(!isempty(proid)){
_DoAjaxAsyncTrue("POST",{"proid":proid},"/webapi/v1/mem/favorites",function(){
bide._warn('添加成功');
});
}
}*/
//修改购物车选择状态
function _uptCartIsChecked(obj){
var id=$(obj).attr("cartId");
var status=$(obj).is(":checked");
/*if(!isempty(id)){
_DoAjaxAsyncTrue("PUT",{"id":id,"status":status},"/webapi/v1/uptCartChecked");
}*/
}
//全选修改选中状态
function _uptCartIsCheckedAll(obj){
var cartids=[];
$.each($(".tab_mycart tbody .input_check"),function(idx,item) {
var cartid = $(this).attr("cartid");
if (!isempty(cartid)) {
cartids.push(cartid);
}
});
/*console.log(cartids);
if(cartids.length>0){
_DoAjaxAsyncTrue("PUT",{"ids":cartids,"status":$("#cart_totle").is(":checked")},"/webapi/v1/uptCartCheckedAll");
}*/
}
//跳转到支付页面
function _toPayMent(){
	window.location.href="/pay/payment.html"
/*if($(".tab_mycart tbody tr:not(.tr_nodata)").has(":checked").length>0){
_aClickOpenWindow("/pay/payment.html","_self");//打开窗口
}*/
}

</script>
</body>
</html>
