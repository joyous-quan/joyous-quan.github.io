<!-- 公共隐藏购物车 -->
<div class="hide_cart">
	<div class="hide_cart_bg"></div>
	<div class="hide_cart_content popups_transition">
		<div class="hide_cart_title bg_blue">
			<span class="cart_hide"><img src="/static/img/index/next.png" alt=""></span><span class="F20">My Cart (<i class="cart_total">4</i>)</span>
		</div>
		<div class="hide_cart_list">
			<table class="cart_ptable">
				<tbody class="cart_ptbody">
					<tr>
						<td rowspan="3"><a href="/" class="cart_pimg"><img src="https://file.bldpharm.com/static/upload/proimg/422/86087-24-3.png" alt=""></a></td>
						<td colspan="3" class="position_r"><button class="cart_pdel">×</button><a href="/" class="cart_pname">(R)-Tetrahydrofuran-3-ol</a></td>
					</tr>
					<tr>
						<td>BD47643</td>
						<td align="center">95%</td>
						<td align="right">10g</td>
					</tr>
					<tr>
						<td>86087-24-3</td>
						<td align="center" class="color_red">USD <span class="cart_pprice">43</span></td>
						<td align="right">
							<input class="unit_price" type="hidden" value="43">
							<label class="cart_pnum"><em class="cart_num_less">-</em><input class="cart_ipt_mun" onpropertychange="" onkeyup="" value="1" min="1" type="number"><em class="cart_num_add">+</em></label>
						</td>
					</tr>
				</tbody>
				<tbody class="cart_ptbody">
					<tr>
						<td rowspan="3"><a href="/" class="cart_pimg"><img src="https://file.bldpharm.com/static/upload/proimg/1307/1844202-89-6.png" alt=""></a></td>
						<td colspan="3" class="position_r"><button class="cart_pdel">×</button><a href="/" class="cart_pname">(3S,4R)-4-(Cyclobutyl(methyl)amino)tetrahydrofuran-3-ol</a></td>
					</tr>
					<tr>
						<td>BD01352698</td>
						<td align="center">98%</td>
						<td align="right">1g</td>
					</tr>
					<tr>
						<td>1844202-89-6</td>
						<td align="center" class="color_red">USD <span class="cart_pprice">96</span></td>
						<td align="right">
							<input class="unit_price" type="hidden" value="96">
							<label class="cart_pnum"><em class="cart_num_less">-</em><input class="cart_ipt_mun" onpropertychange="" onkeyup="" value="1" min="1" type="number"><em class="cart_num_add">+</em></label>
						</td>
					</tr>
				</tbody>
				<tbody class="cart_ptbody">
					<tr>
						<td rowspan="3"><a href="/" class="cart_pimg"><img src="https://file.bldpharm.com/static/upload/proimg/422/86087-24-3.png" alt=""></a></td>
						<td colspan="3" class="position_r"><button class="cart_pdel">×</button><a href="/" class="cart_pname">(R)-Tetrahydrofuran-3-ol(R)-Tetrahydrofuran-3-ol(R)-Tetrahydrofuran-3-ol(R)-Tetrahydrofuran-3-ol(R)-Tetrahydrofuran-3-ol</a></td>
					</tr>
					<tr>
						<td>BD47643</td>
						<td align="center">95%</td>
						<td align="right">10g</td>
					</tr>
					<tr>
						<td>86087-24-3</td>
						<td align="center" class="color_red">USD <span class="cart_pprice">43</span></td>
						<td align="right">
							<input class="unit_price" type="hidden" value="43">
							<label class="cart_pnum"><em class="cart_num_less">-</em><input class="cart_ipt_mun" onpropertychange="" onkeyup="" value="1" min="1" type="number"><em class="cart_num_add">+</em></label>
						</td>
					</tr>
				</tbody>
				<tbody class="cart_ptbody">
					<tr>
						<td rowspan="3"><a href="/" class="cart_pimg"><img src="https://file.bldpharm.com/static/upload/proimg/1307/1844202-89-6.png" alt=""></a></td>
						<td colspan="3" class="position_r"><button class="cart_pdel">×</button><a href="/" class="cart_pname">(3S,4R)-4-(Cyclobutyl(methyl)amino)tetrahydrofuran-3-ol</a></td>
					</tr>
					<tr>
						<td>BD01352698</td>
						<td align="center">98%</td>
						<td align="right">1g</td>
					</tr>
					<tr>
						<td>1844202-89-6</td>
						<td align="center" class="color_red">USD <span class="cart_pprice">96</span></td>
						<td align="right">
							<input class="unit_price" type="hidden" value="96">
							<label class="cart_pnum"><em class="cart_num_less">-</em><input class="cart_ipt_mun" onpropertychange="" onkeyup="" value="1" min="1" type="number"><em class="cart_num_add">+</em></label>
						</td>
					</tr>
				</tbody>
			</table>
			<div class="cart_btn_container">
				<p class="clearfloat">
					<button class="btn_clear_cart">Clear Cart</button>
					<span class="float_r">Subtotal (<i class="cart_total">4</i> items) <strong class="F16 color_red">USD <i class="cart_pricr_total">278</i></strong></span>
				</p>
				<div class="cart_btn_box">
					<button class="btn_min btn_blue btn_transition">Cart Details</button>
					<button class="btn_min btn_red btn_transition float_r" id="checkout">Checkout</button>
				</div>
			</div>
		</div>
	</div>
</div>


<script>
$(document).ready(function(){
	
	$('.cart_hide,.hide_cart_bg').click(function() {
		$('.hide_cart').removeClass('hide_cart_show');
		//$('.bld_mask').hide();
	});

	
	//购物车数量加减
	if($('.cart_pnum').length>0){
        $('.cart_num_less').click(function(){
            var id=$(this).parent().attr('id');
            var ipt=$(this).parent().find('input');
            var val=ipt.val();
            var price=$(this).parent().parent().parent().find('.cart_pprice');
            val=Number(val)-1;
            if(val>0){
                ipt.val(val>0?val:1);
                _sumCoinUpt();
                price.html(parseInt(val*$(this).parent().parent().find('.unit_price').val()));
                /*var cartparams={'quantity':val};
                _DoAjaxAsyncTrue('PUT',cartparams,'/webapi/v1/user/cart/'+id,function(){
                    _uptCartInfo();//更新购物车信息
                });*/
            }
        });
        $('.cart_num_add').click(function(){
            var id=$(this).parent().attr('id');
            var ipt=$(this).parent().find('input');
            var val=ipt.val();
            var price=$(this).parent().parent().parent().find('.cart_pprice');
            val=Number(val)+1;
            ipt.val(val);
            _sumCoinUpt();
            price.html(parseInt(val*$(this).parent().parent().find('.unit_price').val()));
            /*var cartparams={'quantity':val};
            _DoAjaxAsyncTrue('PUT',cartparams,'/webapi/v1/user/cart/'+id,function(){
                _uptCartInfo();//更新购物车信息
            });*/
        });
        $('.cart_pdel').click(function(){
        	var thisobj=$(this).parent().parent().parent();
        	thisobj.remove();
        	_sumCoinUpt()
        })

        /*$('.cart_pdel').click(function(){
            var thisobj=$(this);
            var id=thisobj.parent().attr('id');
            _confBtnBox('Confirm Delete ?',function(){
                //删除
                _DoAjaxAsyncTrue('DELETE',{},'/webapi/v1/user/cart/'+id,function(){
                    _uptCartInfo();//更新购物车信息
                    bld._warn('Delete Successfully!');
                    setTimeout(function(){layer.closeAll();},1500);
                    thisobj.parent().parent().remove();
                    _sumCoinUpt();
                });
            })
        });*/
        /*$('#checkout').click(function(){
            var data='{{ len(cartinfo) }}';
            if(data!='0'){
                window.location.href='/pay/payment.html';
            }
        });*/
    }
    //更新总价
	function _sumCoinUpt(){
		var itemLen=$('.cart_ptbody').length;
		$('.cart_total').html(itemLen);
		if(itemLen==0){
			$('.cart_ptable').append('<tbody class="no_data"><tr><td>No Data</td></tr></tbody>');
			$('.cart_btn_box').html('')
		}
		var sumcoin=0;
		$.each($('.cart_pnum input'), function(idx, item) {
			var rowprice=parseInt($(item).parent().parent().find('.unit_price').val());
			sumcoin+=Number($(item).val())*rowprice;
		});
		$('.cart_pricr_total').html(sumcoin);
	}

})
</script>